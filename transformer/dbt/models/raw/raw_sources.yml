version: 2

sources:
  - name: raw
    description: "Fontes brutas provenientes do dataset de atrasos de voo."
    database: dw
    schema: dbt_raw

    quoting:
      database: false
      schema: false
      identifier: false

    tables:
      # Airlines
      - name: airlines
        description: "Dados brutos das companhias aéreas."
        tests:
          - not_empty
          - required_columns:
              columns: ["iata_code", "airline"]

        columns:
          - name: iata_code
            description: "Código IATA de duas letras que identifica cada companhia aérea."

          - name: airline
            description: "Nome completo da companhia aérea correspondente ao código IATA."

      # Airports
      - name: airports
        description: "Dados brutos dos aeroportos."
        tests:
          - not_empty
          - required_columns:
              columns:
                [
                  "iata_code",
                  "airport",
                  "city",
                  "state",
                  "country",
                  "latitude",
                  "longitude",
                ]

        columns:
          - name: iata_code
            description: "Código IATA de três letras que identifica o aeroporto."

          - name: airport
            description: "Nome oficial do aeroporto."

          - name: city
            description: "Cidade onde o aeroporto está localizado."

          - name: state
            description: "Estado norte-americano associado ao aeroporto."

          - name: country
            description: "País de localização ('USA' para este dataset)."

          - name: latitude
            description: "Latitude geográfica aproximada do aeroporto em graus decimais."

          - name: longitude
            description: "Longitude geográfica aproximada do aeroporto em graus decimais."

      # Flights
      - name: flights
        description: "Dados brutos de voos."
        tests:
          - not_empty
          - required_columns:
              columns:
                [
                  "year",
                  "month",
                  "day",
                  "day_of_week",
                  "airline",
                  "flight_number",
                  "tail_number",
                  "origin_airport",
                  "destination_airport",
                  "scheduled_departure",
                  "departure_time",
                  "departure_delay",
                  "taxi_out",
                  "wheels_off",
                  "scheduled_time",
                  "elapsed_time",
                  "air_time",
                  "distance",
                  "wheels_on",
                  "taxi_in",
                  "scheduled_arrival",
                  "arrival_time",
                  "arrival_delay",
                  "diverted",
                  "cancelled",
                  "cancellation_reason",
                  "air_system_delay",
                  "security_delay",
                  "airline_delay",
                  "late_aircraft_delay",
                  "weather_delay",
                ]

        columns:
          - name: year
            description: "Ano do voo."

          - name: month
            description: "Mês do voo."

          - name: day
            description: "Dia do mês do voo."

          - name: day_of_week
            description: "Dia da semana (0 = domingo)."

          - name: airline
            description: "Código IATA da companhia aérea responsável pelo voo."

          - name: flight_number
            description: "Número identificador do voo."

          - name: tail_number
            description: "Identificador da aeronave (tail number)."

          - name: origin_airport
            description: "Código IATA do aeroporto de origem."

          - name: destination_airport
            description: "Código IATA do aeroporto de destino."

          - name: scheduled_departure
            description: "Horário programado de partida (HHMM)."

          - name: departure_time
            description: "Horário real de partida (HHMM)."

          - name: departure_delay
            description: "Atraso na partida em minutos."

          - name: taxi_out
            description: "Tempo de taxiamento para decolagem, em minutos."

          - name: wheels_off
            description: "Horário em que a aeronave deixou o solo (HHMM)."

          - name: scheduled_time
            description: "Tempo total programado do voo, em minutos."

          - name: elapsed_time
            description: "Tempo total real de voo, em minutos."

          - name: air_time
            description: "Tempo efetivo em cruzeiro (airborne time), em minutos."

          - name: distance
            description: "Distância percorrida pelo voo, em milhas."

          - name: wheels_on
            description: "Horário em que a aeronave tocou o solo (HHMM)."

          - name: taxi_in
            description: "Tempo de taxiamento após pouso."

          - name: scheduled_arrival
            description: "Horário programado de chegada (HHMM)."

          - name: arrival_time
            description: "Horário real de chegada (HHMM)."

          - name: arrival_delay
            description: "Atraso na chegada em minutos."

          - name: diverted
            description: "Indicador de desvio (1 = voo desviado)."

          - name: cancelled
            description: "Indicador de cancelamento (1 = voo cancelado)."

          - name: cancellation_reason
            description: "Código do motivo de cancelamento, quando aplicável."

          - name: air_system_delay
            description: "Atraso atribuído ao sistema de tráfego aéreo."

          - name: security_delay
            description: "Atraso decorrente de procedimentos de segurança."

          - name: airline_delay
            description: "Atraso causado pela própria companhia aérea."

          - name: late_aircraft_delay
            description: "Atraso devido à chegada tardia da aeronave usada no voo."

          - name: weather_delay
            description: "Atraso devido a condições climáticas adversas."
